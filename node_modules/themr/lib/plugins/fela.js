/**
 * @license
 * Copyright (C) 2016 Chi Vinh Le and contributors.
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file for details.
 */
import * as createHash from "murmurhash-js/murmurhash3_gc";
import { createRenderer } from "fela";
var ns = "fela";
var defaults = function () { return ({
    renderer: createRenderer(),
}); };
var plugin = function (pluginOptions) {
    if (pluginOptions === void 0) { pluginOptions = defaults(); }
    return function (_a) {
        var classes = _a.rules.classes, runtime = _a.runtime;
        if (!classes) {
            return;
        }
        if (!runtime[ns]) {
            runtime[ns] = { cache: {} };
        }
        var felaRuntime = runtime[ns];
        var renderer = pluginOptions.renderer;
        var _loop_1 = function (name_1) {
            var hash = createHash(JSON.stringify(classes[name_1]));
            var classNames = felaRuntime.cache[hash];
            if (!classNames) {
                classNames = renderer.renderRule(function () { return classes[name_1]; });
                felaRuntime.cache[hash] = classNames;
            }
            classes[name_1] = classNames;
        };
        for (var name_1 in classes) {
            _loop_1(name_1);
        }
    };
};
export default plugin;

//# sourceMappingURL=fela.js.map
