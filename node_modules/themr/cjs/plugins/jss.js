/**
 * @license
 * Copyright (C) 2016 Chi Vinh Le and contributors.
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file for details.
 */
"use strict";
var createHash = require("murmurhash-js/murmurhash3_gc");
var jss_1 = require("jss");
var ns = "jss";
var defaults = function () { return ({
    jss: jss_1.default,
}); };
var plugin = function (pluginOptions) {
    if (pluginOptions === void 0) { pluginOptions = defaults(); }
    return function (_a) {
        var rules = _a.rules, options = _a.options, runtime = _a.runtime;
        if (!rules.classes) {
            return;
        }
        if (!runtime[ns]) {
            runtime[ns] = { cache: {} };
        }
        var jssRuntime = runtime[ns];
        var jss = pluginOptions.jss;
        var jssOptions = {
            meta: options.name,
            index: options.index,
            named: !options.global,
        };
        var hash = createHash(JSON.stringify(rules.classes));
        var classNames = jssRuntime.cache[hash];
        if (!classNames) {
            var sheet = jss.createStyleSheet(rules.classes, jssOptions);
            sheet.attach();
            classNames = sheet.classes;
            jssRuntime.cache[hash] = classNames;
        }
        rules.classes = classNames;
    };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = plugin;

//# sourceMappingURL=jss.js.map
